{"id": "http://127.0.0.1:8000/api/v2/schema.json#", "$schema": "http://json-schema.org/draft-04/schema#", "description": "Schema for data exchange in DataGator", "oneOf": [{"$ref": "#/definitions/DataSet"}, {"$ref": "#/definitions/DataItem"}, {"$ref": "#/definitions/Message"}, {"$ref": "#/definitions/Page"}, {"$ref": "#/definitions/Repo"}, {"$ref": "#/definitions/Task"}, {"$ref": "#/definitions/Team"}, {"$ref": "#/definitions/User"}], "definitions": {"ISO8601": {"description": "ISO 8601 time format", "type": "string", "pattern": "^(?:[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}|[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]+)(?:|Z|[+\\-]{1}[0-9]{2}:{0,1}[0-9]{2})$"}, "UUID": {"description": "Universally Unique Identifier", "type": "string", "pattern": "^[a-fA-F0-9]{32}|[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"}, "name": {"type": "string", "pattern": "^[A-Za-z]\\w{0,29}$"}, "key": {"type": "string", "pattern": "^(?:[^\"/?#@\\\\\\s]|\\\\[\"'\\\\]){1,128}$"}, "count": {"type": "integer", "minimum": 0}, "Message": {"description": "Non-data responses from DataGator", "type": "object", "properties": {"kind": {"enum": ["datagator#Error", "datagator#Status"]}, "code": {"type": "integer", "minimum": -1024, "maximum": 1023}, "service": {"type": "string"}, "version": {"type": "string"}, "message": {"type": "string"}}, "required": ["kind", "code"], "additionalProperties": true}, "Team": {"description": "Profile of a group of users", "type": "object", "properties": {"kind": {"enum": ["datagator#Team"]}, "name": {"$ref": "#/definitions/name"}}, "required": ["kind", "name"], "additionalProperties": true}, "User": {"description": "Profile of registered user", "type": "object", "properties": {"kind": {"enum": ["datagator#User"]}, "name": {"$ref": "#/definitions/name"}}, "required": ["kind", "name"], "additionalProperties": true}, "Repo": {"description": "Container of DataSet objects", "type": "object", "properties": {"kind": {"enum": ["datagator#Repo"]}, "name": {"$ref": "#/definitions/name"}, "size": {"$ref": "#/definitions/count"}, "items": {"type": "array", "items": {"$ref": "#/definitions/DataSet"}, "minItems": 0, "uniqueItems": true}, "itemsCount": {"$ref": "#/definitions/count"}}, "required": ["kind", "name", "itemsCount"], "additionalProperties": true}, "RepoRef": {"description": "Reference to Repo object", "type": "object", "properties": {"kind": {"enum": ["datagator#Repo"]}, "name": {"$ref": "#/definitions/name"}}, "required": ["kind", "name"], "additionalProperties": false}, "DataSet": {"description": "Container of DataItem objects", "type": "object", "properties": {"kind": {"enum": ["datagator#DataSet"]}, "name": {"$ref": "#/definitions/name"}, "repo": {"$ref": "#/definitions/RepoRef"}, "id": {"$ref": "#/definitions/UUID"}, "rev": {"$ref": "#/definitions/count"}, "created": {"$ref": "#/definitions/ISO8601"}, "created_by": {"$ref": "#/definitions/User"}, "updated": {"$ref": "#/definitions/ISO8601"}, "updated_by": {"oneOf": [{"$ref": "#/definitions/User"}, null]}, "public": {"type": "boolean"}, "size": {"$ref": "#/definitions/count"}, "items": {"type": "array", "items": {"$ref": "#/definitions/DataItemKey"}, "minItems": 0, "uniqueItems": true}, "itemsCount": {"$ref": "#/definitions/count"}}, "anyOf": [{"required": ["kind", "repo", "name"]}, {"required": ["kind", "id"]}], "additionalProperties": true}, "DataItem": {"description": "Components of DataSet", "oneOf": [{"$ref": "#/definitions/Matrix"}, {"$ref": "#/definitions/Opaque"}, {"$ref": "#/definitions/Recipe"}]}, "DataItemKey": {"description": "Access key to DataItem object", "properties": {"kind": {"enum": ["datagator#Matrix", "datagator#Recipe", "datagator#Opaque"]}, "name": {"$ref": "#/definitions/key"}}, "required": ["kind", "name"], "additionalProperties": true}, "Matrix": {"description": "Semi-structured tabular data", "type": "object", "properties": {"kind": {"enum": ["datagator#Matrix"]}, "columnHeaders": {"$ref": "#/definitions/count"}, "rowHeaders": {"$ref": "#/definitions/count"}, "rows": {"type": "array", "items": {"type": "array", "minItems": 0}, "minItems": 1}, "columnsCount": {"$ref": "#/definitions/count"}, "rowsCount": {"$ref": "#/definitions/count"}}, "required": ["kind", "columnHeaders", "rowHeaders", "rows", "columnsCount", "rowsCount"], "additionalProperties": false}, "Opaque": {"description": "Binary data in foreign format", "type": "object", "properties": {"kind": {"enum": ["datagator#Opaque"]}, "data": "string"}, "required": ["kind", "data"], "additionalProperties": false}, "Recipe": {"description": "Data baking instructions", "oneOf": [{"$ref": "#/definitions/Workflow"}], "definitions": {"context": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#context"]}, "items": {"type": "array", "items": {"$ref": "#/definitions/Recipe/definitions/contextItem"}, "minItems": 0, "uniqueItems": false}, "itemsCount": {"$ref": "#/definitions/count"}}, "required": ["kind", "items", "itemsCount"], "additionalProperties": false}, "process": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#process"]}, "items": {"type": "array", "items": {"$ref": "#/definitions/Recipe/definitions/processItem"}, "minItems": 0, "uniqueItems": false}, "itemsCount": {"$ref": "#/definitions/count"}}, "required": ["kind", "items", "itemsCount"], "additionalProperties": false}, "routine": {"type": "object", "patternProperties": {"^[A-Za-z]\\w{0,29}$": {"$ref": "#/definitions/Routine"}}, "additionalProperties": false}, "comment": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#comment"]}, "text": {"type": "string"}}, "required": ["kind", "text"], "additionalProperties": false}, "load": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#load"]}, "from": {"oneOf": [{"$ref": "#/definitions/DataSet"}, {"$ref": "#/definitions/RoutineRef"}]}, "as": {"$ref": "#/definitions/name"}}, "required": ["kind", "from", "as"], "additionalProperties": false}, "layout": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#layout"]}, "columnHeaders": {"$ref": "#/definitions/count"}, "rowHeaders": {"$ref": "#/definitions/count"}}, "required": ["kind", "columnHeaders", "rowHeaders"], "additionalProperties": false}, "index": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#index"]}, "on": {"$ref": "#/definitions/name"}, "by": {"$ref": "#/definitions/Recipe/definitions/expr"}}, "required": ["kind", "on", "by"], "additionalProperties": false}, "yield": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#yield"]}, "expr": {"$ref": "#/definitions/Recipe/definitions/expr"}}, "required": ["kind", "expr"], "additionalProperties": false}, "for": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#for"]}, "cursor": {"$ref": "#/definitions/Recipe/definitions/lvalue"}, "in": {"$ref": "#/definitions/Recipe/definitions/expr"}, "items": {"type": "array", "items": {"$ref": "#/definitions/Recipe/definitions/compoundItem"}, "minItems": 1, "uniqueItems": false}, "itemsCount": {"$ref": "#/definitions/count"}}, "required": ["kind", "cursor", "in", "items", "itemsCount"], "additionalProperties": false}, "if": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#if"]}, "cond": {"$ref": "#/definitions/Recipe/definitions/expr"}, "items": {"type": "array", "items": {"$ref": "#/definitions/Recipe/definitions/compoundItem"}, "minItems": 1, "uniqueItems": false}, "itemsCount": {"$ref": "#/definitions/count"}, "else": {"$ref": "#/definitions/Recipe/definitions/else"}}, "required": ["kind", "cond", "items", "itemsCount"], "additionalProperties": false}, "else": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#else"]}, "items": {"type": "array", "items": {"$ref": "#/definitions/Recipe/definitions/compoundItem"}, "minItems": 1, "uniqueItems": false}, "itemsCount": {"$ref": "#/definitions/count"}}, "required": ["kind", "items", "itemsCount"], "additionalProperties": false}, "continue": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#continue"]}}, "required": ["kind"], "additionalProperties": false}, "break": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#break"]}}, "required": ["kind"], "additionalProperties": false}, "pass": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#pass"]}}, "required": ["kind"], "additionalProperties": false}, "assign": {"type": "object", "properties": {"kind": {"enum": ["datagator#Recipe#assign"]}, "to": {"$ref": "#/definitions/Recipe/definitions/lvalue"}, "expr": {"$ref": "#/definitions/Recipe/definitions/expr"}}, "required": ["kind", "to", "expr"], "additionalProperties": false}, "contextItem": {"oneOf": [{"$ref": "#/definitions/Recipe/definitions/comment"}, {"$ref": "#/definitions/Recipe/definitions/load"}]}, "processItem": {"oneOf": [{"$ref": "#/definitions/Recipe/definitions/comment"}, {"$ref": "#/definitions/Recipe/definitions/layout"}, {"$ref": "#/definitions/Recipe/definitions/index"}, {"$ref": "#/definitions/Recipe/definitions/yield"}, {"$ref": "#/definitions/Recipe/definitions/for"}, {"$ref": "#/definitions/Recipe/definitions/if"}, {"$ref": "#/definitions/Recipe/definitions/assign"}]}, "compoundItem": {"oneOf": [{"$ref": "#/definitions/Recipe/definitions/comment"}, {"$ref": "#/definitions/Recipe/definitions/layout"}, {"$ref": "#/definitions/Recipe/definitions/index"}, {"$ref": "#/definitions/Recipe/definitions/yield"}, {"$ref": "#/definitions/Recipe/definitions/for"}, {"$ref": "#/definitions/Recipe/definitions/if"}, {"$ref": "#/definitions/Recipe/definitions/assign"}, {"$ref": "#/definitions/Recipe/definitions/continue"}, {"$ref": "#/definitions/Recipe/definitions/break"}, {"$ref": "#/definitions/Recipe/definitions/pass"}]}, "lvalue": {"type": "string"}, "expr": {"type": "string"}}}, "Workflow": {"description": "Workflow Recipe (top-level object)", "type": "object", "properties": {"kind": {"enum": ["datagator#Recipe"]}, "context": {"$ref": "#/definitions/Recipe/definitions/context"}, "process": {"$ref": "#/definitions/Recipe/definitions/process"}, "routine": {"$ref": "#/definitions/Recipe/definitions/routine"}}, "required": ["kind", "context", "process"], "additionalProperties": false}, "Routine": {"description": "Inline Recipe (embedded in a Workflow object)", "type": "object", "properties": {"kind": {"enum": ["datagator#Recipe"]}, "context": {"$ref": "#/definitions/Recipe/definitions/context"}, "process": {"$ref": "#/definitions/Recipe/definitions/process"}}, "required": ["kind", "context", "process"], "additionalProperties": false}, "RoutineRef": {"description": "Reference to local Routine object", "type": "object", "patternProperties": {"^\\$ref$": {"type": "string", "pattern": "^#/routine/[A-Za-z]\\w{0,29}$"}}, "additionalProperties": false}, "Task": {"description": "Asynchronous job", "properties": {"kind": {"enum": ["datagator#Task"]}, "id": {"$ref": "#/definitions/UUID"}, "repo": {"$ref": "#/definitions/RepoRef"}, "created": {"$ref": "#/definitions/ISO8601"}, "status": {"enum": ["PED", "RUN", "SUC", "ERR"]}, "options": {"type": "object"}, "handler": {"type": "string"}, "args": {"type": "array"}, "kwargs": {"type": "object"}}, "required": ["kind", "options", "handler", "args", "kwargs"], "additionalProperties": true}, "Page": {"description": "Paginated list of any item", "properties": {"kind": {"enum": ["datagator#Page"]}, "items": {"type": "array", "items": {"oneOf": [{"$ref": "#/definitions/DataSet"}, {"$ref": "#/definitions/DataItemKey"}, {"$ref": "#/definitions/DataItem"}, {"$ref": "#/definitions/Message"}, {"$ref": "#/definitions/Page"}, {"$ref": "#/definitions/Repo"}, {"$ref": "#/definitions/Task"}, {"$ref": "#/definitions/Team"}, {"$ref": "#/definitions/User"}]}, "minItems": 0, "uniqueItems": true}, "startIndex": {"$ref": "#/definitions/count"}, "itemsPerPage": {"$ref": "#/definitions/count"}, "itemsCount": {"$ref": "#/definitions/count"}}, "required": ["kind", "items", "startIndex", "itemsPerPage", "itemsCount"], "additionalProperties": true}}}